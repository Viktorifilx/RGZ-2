{% extends "base.html" %}

{% block title %}{{ street.name }} ‚Äî —è—Ä–º–∞—Ä–∫–∞{% endblock %}

{% block content %}
<section class="street-hero">
    <a href="{{ url_for('index') }}" class="back-link">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —è—Ä–º–∞—Ä–æ—á–Ω—É—é –ø–ª–æ—â–∞–¥—å</a>
    <h1>{{ street.name }}</h1>
    <p>–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–º–∏–∫-–ø–∞–≤–∏–ª—å–æ–Ω –≤–¥–æ–ª—å –¥–æ—Ä–æ–∂–∫–∏ üëá</p>
</section>

<section class="street-map-section">
    <div class="street-map">
        <img
            src="{{ url_for('static', filename='images/street_bg.png') }}"
            alt="–ö–∞—Ä—Ç–∞ —É–ª–∏—Ü—ã"
            class="street-bg"
        >

        <div class="pavilions-layer">
            {% set max_slots = 5 %}
            {% set pav_list = pavilions[:max_slots] %}

            {% for slot in range(1, max_slots + 1) %}
                {% set pav = pav_list[loop.index0] if loop.index0 < pav_list|length else None %}

                {% if pav %}
                    <a href="{{ url_for('pavilion_page', pavilion_id=pav.id) }}"
                       class="pavilion slot-{{ slot }} has-ad">
                        <div class="pavilion-inner">
                            <img src="{{ url_for('static', filename='icons/house.PNG') }}"
                                 alt="–ü–∞–≤–∏–ª—å–æ–Ω"
                                 class="pavilion-img">
                            <div class="pavilion-badge">
                                <div class="pavilion-title">{{ pav.title }}</div>
                                <div class="pavilion-master">
                                    –¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π: {{ pav.ads|length }}
                                </div>
                            </div>
                        </div>
                    </a>
                {% else %}
                    {% if session.get('user_role') in ['master', 'admin'] %}
                        <a href="{{ url_for('pavilion_request', street_id=street.id) }}"
                           class="pavilion slot-{{ slot }} empty can-request">
                            <div class="pavilion-inner">
                                <img src="{{ url_for('static', filename='icons/house.PNG') }}"
                                     alt="–°–≤–æ–±–æ–¥–Ω—ã–π –ø–∞–≤–∏–ª—å–æ–Ω"
                                     class="pavilion-img">
                                <div class="pavilion-badge">
                                    <div class="pavilion-title">–°–≤–æ–±–æ–¥–Ω—ã–π –ø–∞–≤–∏–ª—å–æ–Ω</div>
                                    <div class="pavilion-master">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ç–µ–º—É</div>
                                </div>
                            </div>
                        </a>
                    {% else %}
                        <div class="pavilion slot-{{ slot }} empty">
                            <div class="pavilion-inner">
                                <img src="{{ url_for('static', filename='icons/house.PNG') }}"
                                     alt="–°–≤–æ–±–æ–¥–Ω—ã–π –ø–∞–≤–∏–ª—å–æ–Ω"
                                     class="pavilion-img">
                                <div class="pavilion-badge">
                                    <div class="pavilion-title">–°–≤–æ–±–æ–¥–Ω—ã–π –ø–∞–≤–∏–ª—å–æ–Ω</div>
                                    <div class="pavilion-master">–ú–µ—Å—Ç–æ –¥–ª—è –Ω–æ–≤–æ–π —Ç–µ–º—ã</div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endif %}
            {% endfor %}
        </div>
    </div>
</section>

<div class="street-support-hint">
    –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å? <a href="{{ url_for('support') }}">–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</a>.
</div>

<style>
    .street-support-hint {
        max-width: 960px;
        margin: 16px auto 0;
        font-size: 14px;
        color: #555;
    }
    .street-support-hint a {
        color: #ec4899;
        text-decoration: none;
        font-weight: 500;
    }
    .street-support-hint a:hover {
        text-decoration: underline;
    }
</style>
{% endblock %}
