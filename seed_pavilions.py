from app import app, db, Street, Pavilion, Ad

with app.app_context():
    # Пересоздаём БД
    db.drop_all()
    db.create_all()

    # ----- УЛИЦЫ -----
    it = Street(name="Техно-улица", code="it")
    design = Street(name="Арбат творчества", code="design")
    study = Street(name="Аллея знаний", code="study")
    photo = Street(name="Светлая улица", code="photo")

    db.session.add_all([it, design, study, photo])
    db.session.commit()

    # ----- ПАВИЛЬОНЫ (тематики) -----

    pavilions_data = [
        # Техно-улица
        (it, "Python & Flask",
         "Помощь с лабораторными, бэкендом на Flask и учебными проектами."),
        (it, "SQL и базы данных",
         "Запросы, джоины, нормализация, работа с PostgreSQL и SQLite."),
        (it, "Data Science & аналитика",
         "Pandas, визуализация, простые модели и обработка данных."),
        (it, "Алгоритмы и структуры данных",
         "Разбор задач по алгоритмам, подготовка к зачётам и собеседованиям."),
        (it, "Учебные IT-проекты",
         "Помощь с курсовыми и мини-проектами по программированию."),

        # Арбат творчества
        (design, "Презентации и слайды",
         "Красивые и понятные слайды для защиты работ и выступлений."),
        (design, "Графический дизайн",
         "Афиши, постеры, обложки, оформление для соцсетей."),
        (design, "UX/UI для учебных проектов",
         "Прототипы, интерфейсы и логика экранов для pet-проектов."),
        (design, "Брендинг и айдентика",
         "Логотипы, палитры, гайды по стилю для учебных команд."),
        (design, "Верстка печатных материалов",
         "Макеты листовок, буклетов и мини-журналов."),

        # Аллея знаний
        (study, "Математика и статистика",
         "Подготовка к контрольным и зачётам по матану и теорверу."),
        (study, "Экономика и финансы",
         "Задачи по микро/макроэкономике, анализ отчётности."),
        (study, "Бизнес-информатика",
         "BPMN, архитектура предприятия, кейсы и отчёты."),
        (study, "Иностранные языки",
         "Помощь с домашкой и устной подготовкой по языкам."),
        (study, "Курсовые и отчёты",
         "Структура, оформление, проверка логики текста."),

        # Светлая улица
        (photo, "Аватарки и портреты",
         "Фотосъёмка и обработка аватарок для соцсетей и резюме."),
        (photo, "Учебные фотопроекты",
         "Съёмка для творческих заданий и учебных журналов."),
        (photo, "Контент для соцсетей",
         "Серии фото, сторис-формат, визуал ленты."),
        (photo, "Обработка и ретушь",
         "Цветокор, ретушь, аккуратные правки без перебора."),
        (photo, "Видео и короткие ролики",
         "Монтаж коротких видео, клипы под музыку и рилс-формат."),
    ]

    pavilions = []
    for street, title, desc in pavilions_data:
        pav = Pavilion(title=title, description=desc, street=street)
        db.session.add(pav)
        pavilions.append(pav)

    db.session.commit()

    # Чтобы удобно ссылаться
    def pav(street_code, title):
        return Pavilion.query.join(Street).filter(
            Street.code == street_code,
            Pavilion.title == title
        ).first()

    ads = []

    # ----- Объявления для Техно-улицы -----

    # Python & Flask
    p = pav("it", "Python & Flask")
    ads += [
        Ad(
            title="Разбор лабораторных по Flask",
            text="Помогу понять роуты, шаблоны и работу с формами на примере ваших лаб.",
            author_name="Кирилл",
            pavilion=p
        ),
        Ad(
            title="Мини-проект на Flask под сдачу",
            text="Сделаем вместе небольшой сайт: авторизация, простая БД, пара страниц.",
            author_name="Алина",
            pavilion=p
        ),
        Ad(
            title="Настройка виртуального окружения и структуры проекта",
            text="Разберёмся с venv, requirements, запуском из PyCharm/VS Code.",
            author_name="Максим",
            pavilion=p
        ),
        Ad(
            title="Поясню, как работает Jinja2",
            text="Циклы, условия, наследование шаблонов — на примерах из ваших заданий.",
            author_name="Софья",
            pavilion=p
        ),
        Ad(
            title="Подготовка к защите Flask-проекта",
            text="Помогу оформить демонстрацию, рассказать про архитектуру и код.",
            author_name="Екатерина",
            pavilion=p
        ),
    ]

    # SQL и базы данных
    p = pav("it", "SQL и базы данных")
    ads += [
        Ad(
            title="SELECT, JOIN и подзапросы",
            text="Разберём сложные запросы по вашим вариантам: соединения, группировки.",
            author_name="Иван",
            pavilion=p
        ),
        Ad(
            title="Нормализация и проектирование БД",
            text="Помогу аккуратно нарисовать схему и перевести её в таблицы.",
            author_name="Мария",
            pavilion=p
        ),
        Ad(
            title="Отладка запросов PostgreSQL",
            text="Если запрос «не работает» или выдаёт ерунду — разберём по шагам.",
            author_name="Дмитрий",
            pavilion=p
        ),
        Ad(
            title="PL/pgSQL: функции и триггеры",
            text="Покажу, как писать простые функции под ваши задания.",
            author_name="Анна",
            pavilion=p
        ),
        Ad(
            title="Оптимизация запросов под большие таблицы",
            text="Объясню индексы и как не делать миллион ненужных строк.",
            author_name="Никита",
            pavilion=p
        ),
    ]

    # Data Science & аналитика
    p = pav("it", "Data Science & аналитика")
    ads += [
        Ad(
            title="Pandas с нуля до отчёта",
            text="Загрузим данные, почистим, посчитаем показатели и сделаем графики.",
            author_name="Олег",
            pavilion=p
        ),
        Ad(
            title="Введение в машинное обучение",
            text="Покажу, как сделать первую модель классификации/регрессии для лабы.",
            author_name="Вероника",
            pavilion=p
        ),
        Ad(
            title="Matplotlib и красивые графики",
            text="Настроим стиль, подписи и легенды под отчёт.",
            author_name="Степан",
            pavilion=p
        ),
        Ad(
            title="Jupyter Notebook под защиту",
            text="Помогу оформить ноутбук так, чтобы по нему было удобно рассказывать.",
            author_name="Тимур",
            pavilion=p
        ),
        Ad(
            title="Разбор кредитного скоринга",
            text="Объясню WOE/IV, логистическую регрессию и ROC-кривую на примере.",
            author_name="Полина",
            pavilion=p
        ),
    ]

    # Алгоритмы и структуры данных
    p = pav("it", "Алгоритмы и структуры данных")
    ads += [
        Ad(
            title="Подготовка к коллоквиуму по алгоритмам",
            text="Сортировки, поиск, сложность O(n) — объясню простым языком.",
            author_name="Артём",
            pavilion=p
        ),
        Ad(
            title="Задачи с LeetCode/Codeforces для практики",
            text="Разберём несколько задач именно под ваш уровень.",
            author_name="Елизавета",
            pavilion=p
        ),
        Ad(
            title="Структуры данных в Python",
            text="Списки, стеки, очереди, словари и как их использовать в задачах.",
            author_name="Руслан",
            pavilion=p
        ),
        Ad(
            title="Решение задач перед зачётом",
            text="Пройдёмся по типовым примерам, чтобы не бояться билетов.",
            author_name="Наталья",
            pavilion=p
        ),
        Ad(
            title="Подготовка к собеседованию junior",
            text="Соберём набор базовых задач и проговорим решения.",
            author_name="Ксения",
            pavilion=p
        ),
    ]

    # Учебные IT-проекты
    p = pav("it", "Учебные IT-проекты")
    ads += [
        Ad(
            title="Помощь с выбором темы pet-проекта",
            text="Придумаем идею, которую реально успеть сделать за семестр.",
            author_name="Герман",
            pavilion=p
        ),
        Ad(
            title="Разбор ТЗ и требований",
            text="Разберём, что реально нужно сделать для зачёта, а что лишнее.",
            author_name="Дарья",
            pavilion=p
        ),
        Ad(
            title="Код-ревью вашего проекта",
            text="Посмотрю структуру, сделаю рекомендации по улучшению.",
            author_name="Илья",
            pavilion=p
        ),
        Ad(
            title="Подготовка презентации проекта",
            text="Соберём слайды: проблема, решение, демонстрация, выводы.",
            author_name="Юлия",
            pavilion=p
        ),
        Ad(
            title="Помощь перед дедлайном",
            text="Разберёмся с багами и приведём проект в сдаваемый вид.",
            author_name="Владимир",
            pavilion=p
        ),
    ]

    # ----- Арбат творчества, Аллея знаний, Светлая улица -----
    # Чтобы не раздувать файл до безумия, делаем по 5 объявлений в каждом павильоне
    # по аналогии с Техно-улицей (тексты тоже про творчество, учёбу и фото).

    def add_ads_for_pavilion(street_code, pav_title, ads_info):
        p = pav(street_code, pav_title)
        for title, text, author in ads_info:
            ads.append(Ad(title=title, text=text, author_name=author, pavilion=p))

    # Арбат творчества
    add_ads_for_pavilion("design", "Презентации и слайды", [
        ("Презентация под защиту диплома",
         "Сделаю аккуратные слайды в едином стиле, помогу расставить акценты.",
         "Арина"),
        ("Оформление учебного проекта",
         "Слайды + простая инфографика под рассказ преподавателю.",
         "Михаил"),
        ("Переработка существующей презентации",
         "Уберём лишнее, добавим визуал и читаемость.",
         "Виктория"),
        ("Шаблон презентации для группы",
         "Сделаю шаблон, который сможете использовать всей командой.",
         "Сергей"),
        ("Советы по выступлению",
         "Подскажу, как уложиться во время и не утонуть в тексте.",
         "Елена"),
    ])

    add_ads_for_pavilion("design", "Графический дизайн", [
        ("Обложки для студенческого журнала",
         "Помогу придумать стиль, подобрать шрифты и собрать макет.",
         "Кристина"),
        ("Афиша мероприятия",
         "Яркий постер для Дня открытых дверей или концерта.",
         "Даниил"),
        ("Оформление ленты в ВК/Telegram",
         "Сделаю несколько шаблонов постов в одном стиле.",
         "Алёна"),
        ("Редизайн старого плаката",
         "Обновлю старый дизайн, но сохраню идею.",
         "Павел"),
        ("Иконки и пиктограммы",
         "Набор простых и понятных иконок для презентаций и сайтов.",
         "Светлана"),
    ])

    add_ads_for_pavilion("design", "UX/UI для учебных проектов", [
        ("Прототип сайта в Figma",
         "Сделаем кликабельный прототип, который можно показать на защите.",
         "Роман"),
        ("Анализ юзабилити вашего проекта",
         "Подскажу, как упростить навигацию и убрать лишнее.",
         "Инна"),
        ("Мобильный интерфейс для pet-проекта",
         "Скетчи экранов и базовый прототип.",
         "Лев"),
        ("Подготовка UI-кита",
         "Кнопки, поля, состояния — чтобы фронту было проще верстать.",
         "Маргарита"),
        ("Разбор Figma-файла",
         "Приведём ваш проект в порядок: страницы, стили, компоненты.",
         "Кирилл"),
    ])

    add_ads_for_pavilion("design", "Брендинг и айдентика", [
        ("Мини-логотип для учебного проекта",
         "Простой, но аккуратный знак + подбор шрифтов.",
         "Оксана"),
        ("Палитра и стиль для команды",
         "Помогу подобрать цвета и шрифты для чатов, презентаций, досок.",
         "Григорий"),
        ("Обложки для курсовых и отчётов",
         "Единый стиль обложек под разные предметы.",
         "Татьяна"),
        ("Наклейки/стикеры по вашей теме",
         "Придумаем и нарисуем несколько вариантов.",
         "Егор"),
        ("Мини-гайд по использованию стиля",
         "Короткий PDF, как не ломать дизайн проекта.",
         "Варя"),
    ])

    add_ads_for_pavilion("design", "Верстка печатных материалов", [
        ("Буклет формата A4",
         "Сверстаю буклет по вашему тексту и картинкам.",
         "Ирина"),
        ("Журнальная полоса в стиле редакции",
         "Сделаю полосу под студенческий журнал или газету.",
         "Назар"),
        ("Листовка-приглашение",
         "Простой макет, который можно распечатать в типографии.",
         "Соня"),
        ("Оформление методички",
         "Помогу привести текст и таблицы к единому стилю.",
         "Арсений"),
        ("Проверка перед печатью",
         "Проверю вылеты, поля, качество изображений.",
         "Карина"),
    ])

    # Аллея знаний
    add_ads_for_pavilion("study", "Математика и статистика", [
        ("Разбор задач по матану",
         "Помогу понять методы и решить типовые задачи перед зачётом.",
         "Андрей"),
        ("Подготовка к тесту по теорверу",
         "Решим несколько вариантов, объясню формулы.",
         "Лидия"),
        ("Практика по статистике в Excel",
         "Средние, дисперсии, корреляции и простые графики.",
         "Марат"),
        ("Мат. часть для Data Science",
         "Объясню минимум математики, который нужен для моделей.",
         "Жанна"),
        ("Консультация перед экзаменом",
         "Структурируем темы и вопросы, сделаем чек-лист.",
         "Виталий"),
    ])

    add_ads_for_pavilion("study", "Экономика и финансы", [
        ("Задачи по микроэкономике",
         "Спрос-предложение, эластичность, оптимум фирмы.",
         "Фёдор"),
        ("Анализ финансовой отчётности",
         "Баланс, ОФР, коэффициенты — разберём на примере.",
         "Эльмира"),
        ("Подготовка к коллоквиуму по ДКР",
         "Краткий конспект + разбор задач.",
         "Александр"),
        ("Курсовая по финансам: структура",
         "Помогу разложить работу на главы и подразделы.",
         "Галина"),
        ("Инвестиционные расчёты",
         "NPV, IRR, срок окупаемости — на простых числах.",
         "Кирилл"),
    ])

    add_ads_for_pavilion("study", "Бизнес-информатика", [
        ("BPMN-диаграммы",
         "Помогу нарисовать процессы так, чтобы их понял преподаватель.",
         "Милана"),
        ("Архитектура предприятия",
         "Разберём слои и нотации из методички.",
         "Станислав"),
        ("Карта приложений",
         "Соберём аккуратную схему взаимодействия систем.",
         "Юлия"),
        ("Подготовка отчёта по практике",
         "Структура, рисунки, ссылки на приложения.",
         "Николай"),
        ("Проверка работы перед сдачей",
         "Посмотрю на логику, оформление и соответствие заданию.",
         "Лада"),
    ])

    add_ads_for_pavilion("study", "Иностранные языки", [
        ("Разговорная практика перед зачётом",
         "Потренируемся говорить по темам билетов.",
         "Оливер"),
        ("Проверка сочинения/эссе",
         "Подправлю грамматику и стилистику.",
         "Екатерина"),
        ("Подготовка к тесту по грамматике",
         "Сделаем подборку заданий по слабым местам.",
         "Денис"),
        ("Разбор презентации на английском",
         "Помогу отрепетировать выступление.",
         "Рита"),
        ("Перевод сложного текста",
         "Разберём терминологию и структуру.",
         "Влад"),
    ])

    add_ads_for_pavilion("study", "Курсовые и отчёты", [
        ("Помощь с планом курсовой",
            "Сформируем тему, цель, задачи и структуру.",
            "Марина"),
        ("Редактирование текста",
            "Уберём повторы, добавим логичные переходы.",
            "Антон"),
        ("Оформление по ГОСТу",
            "Поля, шрифт, списки, ссылки, содержание.",
            "Сабина"),
        ("Подготовка презентации к курсовой",
            "Соберём слайды по главам и выводам.",
            "Вячеслав"),
        ("Финальная проверка перед сдачей",
            "Пробегусь по всей работе и дам список правок.",
            "Аделина"),
    ])

    # Светлая улица
    add_ads_for_pavilion("photo", "Аватарки и портреты", [
        ("Портретная фотосессия в аудитории",
         "Сделаем несколько кадров для резюме и соцсетей.",
         "Игорь"),
        ("Уличные портреты",
         "Прогулка 30–40 минут, 5–7 обработанных фото.",
         "Нина"),
        ("Фотодень для группы",
         "Сделаем общий кадр + несколько индивидуальных.",
         "Рустам"),
        ("Обработка уже готовых фото",
         "Подправлю цвет и освещение.",
         "Диана"),
        ("Аватарка в одном стиле для команды",
         "Сделаем серию похожих портретов.",
         "Сергей"),
    ])

    add_ads_for_pavilion("photo", "Учебные фотопроекты", [
        ("Помощь с идеей проекта",
         "Придумаем концепцию под требования преподавателя.",
         "Яна"),
        ("Съёмка серии кадров",
         "Помогу со светом, ракурсами и сюжетами.",
         "Кирилл"),
        ("Сборка проекта в PDF/презентацию",
         "Упакуем фото и текст в аккуратный файл.",
         "Оксана"),
        ("Подготовка к защите фотопроекта",
         "Продумать рассказ, последовательность, акценты.",
         "Леонид"),
        ("Мини-портфолио",
         "Соберём 10–15 кадров в одном стиле.",
         "Лилия"),
    ])

    add_ads_for_pavilion("photo", "Контент для соцсетей", [
        ("Съёмка контента для блога",
         "Сделаем фото для постов и сторис.",
         "Артём"),
        ("Идеи для визуала ленты",
         "Подберём цветовую схему и формат.",
         "Дарья"),
        ("Серии фото «до/после»",
         "Под учёбу или кейсы.",
         "Костя"),
        ("Обработка под определённый пресет",
         "Сделаю пару вариантов стиля.",
         "Мира"),
        ("Проверка контента перед публикацией",
         "Советы по выбору удачных кадров.",
         "Филипп"),
    ])

    add_ads_for_pavilion("photo", "Обработка и ретушь", [
        ("Чистая ретушь лица",
         "Без пластики, аккуратное выравнивание кожи.",
         "Анна"),
        ("Исправление цвета",
         "Сделаю естественный свет и приятные оттенки.",
         "Глеб"),
        ("Удаление лишних объектов",
         "Уберём людей на заднем плане, мусор и т.п.",
         "София"),
        ("Подготовка фото к печати",
         "Настрою разрешение и формат под типографию.",
         "Михаил"),
        ("Стилизация под плёнку",
         "Сделаем атмосферный плёночный оттенок.",
         "Злата"),
    ])

    add_ads_for_pavilion("photo", "Видео и короткие ролики", [
        ("Монтаж вертикального видео",
         "Соберу ролик до 60 секунд с музыкой и титрами.",
         "Роман"),
        ("Сборка видеодневника",
         "Сделаем ролик про поездку или мероприятие.",
         "Елизавета"),
        ("Монтаж учебного видео",
         "Аккуратные склейки, титры, простая графика.",
         "Святослав"),
        ("Рилсы/шортсы из исходников",
         "Нарежем самое лучшее, подберём звук.",
         "Катя"),
        ("Консультация по структуре ролика",
         "Как сделать, чтобы видео смотрели до конца.",
         "Макар"),
    ])

    db.session.add_all(ads)
    db.session.commit()

    print("Готово! Улицы, павильоны и объявления созданы.")
